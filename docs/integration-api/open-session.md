---
sidebar_position: 4
---

# Open Session

In order to open a session, send a GET request to the **open-session** endpoint. The server will respond with an `iframeURL` that you can open in a new window, the current window, or embed in an iframe to display the BidPaw lobby.

The following diagram describes the interactions between a player, your casino, and BidPaw when a user opens the lobby for the first time after registration:

![Authorization scheme](/img/auth-scheme.jpeg)

---

## Endpoint URL

```
GET https://API_URL/api/casino/open-session/?clientId={CLIENT_ID}&userId={USER_ID}&nick={optional_nickname}&lang={lang}&currency={currency}&country={country}&gameId={gameId}
```

## Request Headers

| Parameter Name | Description                                               | Required / Optional |
| -------------: | --------------------------------------------------------- | ------------------: |
|         `sign` | Request signature, generated using your shared secret key |            Required |

## Request Parameters

|     Parameter Name | Description                                                                                                                         | Required / Optional |
|-------------------:|-------------------------------------------------------------------------------------------------------------------------------------|--------------------:|
|         `clientId` | Casino identifier generated by casino.                                                                                              |            Required |
|           `userId` | Unique user identifier from your system.                                                                                            |            Required |
|             `nick` | User's nickname or display name. If omitted, a random ID will be generated.                                                         |            Optional |
|             `lang` | Language code for the user interface. Used to generate the `iframeURL` with the correct locale prefix. Defaults to `en`.            |            Optional |
|         `currency` | Player's currency code. Must be one of the supported currencies (see list below). Persisted for the user and used for pricing bids. |            Optional |
|          `country` | User's country code. If the country is in the restricted list, the user is redirected to a "Region Not Supported" page.             |            Optional |
|         `gameId`   | Unique game identifier. Attached to callbacks for session tracking.                                                                 |            Required |
| `allowedCountries` | Comma-separated list of supported countriesâ€™ ISO codes. (allowedCountries=US,GB,BY,RU)                                              |            Optional |

### Supported Currencies

* USDT
* UYU
* VES
* ZAR
* PKR
* PLN
* PYG
* RUB
* SEK
* SVC
* THB
* TND
* TRY
* USD
* INR
* JPY
* KZT
* LKR
* MXN
* NGN
* NOK
* NZD
* PEN
* PHP
* CNY
* COP
* CRC
* CZK
* DOP
* EUR
* GBP
* GEL
* HNL
* HUF
* AMD
* AUD
* AZN
* BDT
* BRL
* CAD
* CHF
* CLP

### Restricted Countries

The list of restricted countries is provided by the casino to BidPaw. If `country` matches any restricted entry, access is denied and the `iframeURL` will point to the region-restriction page.

---

## Parameter Validation and Error Handling

1. **Missing Required Parameters**

   * The endpoint checks for `clientId`, `userId`, and `gameId`.
   * If any are missing or empty, the server responds with **HTTP 400** and JSON:

     ```json
     {
       "data": null,
       "status": 400,
       "message": "Required parameters missing: {param1, param2, ...}"
     }
     ```

2. **Signature Validation**

   * The `sign` header must be present and valid.
   * If `sign` is missing or not a string, the server responds with **HTTP 400** and JSON:

     ```json
     {
       "data": null,
       "status": 400,
       "message": "Not valid request. Missing required sign header."
     }
     ```
   * If `sign` is present but fails verification, the server responds with **HTTP 400** and JSON:

     ```json
     {
       "data": null,
       "status": 400,
       "message": "Request signature invalid"
     }
     ```

3. **Country Restriction**

   * If `country` is in the restricted list, the response will still be **HTTP 200** but the generated `iframeURL` will point to:

     ```
     {BASE_IFRAME_URL}/{localePrefix}/region-restriction?token={token}&session={sessionId}&casinoId={clientId}
     ```
   * The user will not be allowed to access the auctions page.

4. **Server Errors**

   * Any unexpected error returns **HTTP 500** with JSON:

     ```json
     {
       "data": null,
       "status": 500,
       "message": "{error message}"  
     }
     ```

---

## Response

| Parameter Name | Description                                        | Required / Optional |
| -------------: | -------------------------------------------------- | ------------------: |
|    `iframeURL` | The URL to load in an iframe for the BidPaw lobby. |            Required |

### Successful Response Example

```json
{
   "iframeURL": "https://bidpaw-tap-to-earn.web.app/auctions?token=...&session=...&casinoId=..."
}
```

### Error Response Examples

**Missing Parameters** (HTTP 400)

```json
{
   "data": null,
   "status": 400,
   "message": "Required parameters missing: clientId, userId, gameId"
}
```

**Invalid Signature** (HTTP 400)

```json
{
   "data": null,
   "status": 400,
   "message": "Request signature invalid"
}
```

**Internal Error** (HTTP 500)

```json
{
   "data": null,
   "status": 500,
   "message": "Internal server error"
}
```

---

## Parameter Descriptions

* **lang**: Determines the UI language. Supported values include language codes such as `en`, `es`, `fr`. If an unsupported language is provided, English (`en`) is used by default. This value affects the generated `iframeURL` via `getLocalePrefix(lang)`.

* **currency**: Sets the player's currency for displaying bid pack prices. Must be one of the supported currency codes. This preference is stored permanently for the user and used when calling the balance-charge endpoint. Bid pack prices are converted server-side.

* **country**: Indicates the user's country. If the country is in the casino's restricted list, access is limited, and the lobby redirects to the region-restriction page. The restricted list is managed by the casino.

* **gameId**: A global identifier linking the provider, platform, and casino for session tracking and callbacks. It must be supplied when opening a session and is echoed in all subsequent callback requests from BidPaw.
